<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commission Settings - Admin</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .product-table { width: 100%; border-collapse: collapse; margin-top: 30px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); }
        .product-table th, .product-table td { padding: 15px; text-align: left; border-bottom: 1px solid #333; }
        .product-table th { background-color: #2a2a2a; color: #ffc107; font-size: 1rem; font-weight: 700; text-transform: uppercase; }
        .product-table td { background-color: #1e1e1e; color: #e0e0e0; font-size: 0.95rem; }
        .product-table tbody tr:nth-child(even) td { background-color: #1a1a1a; }
        .product-table tr:hover td { background-color: #252525; }
        .product-table .category-header { background-color: #00aaff; color: #121212; font-size: 1.1rem; text-align: center; font-weight: 900; padding: 10px; border-bottom: 3px solid #00ff88; }
        .product-table .price-input { background-color: #121212; border: 1px solid #444; color: #00ff88; padding: 8px; width: 80px; border-radius: 4px; text-align: center; font-weight: 700; }
        .product-table .btn-save { background-color: #00aaff; color: white; padding: 10px 30px; border: none; border-radius: 5px; cursor: pointer; font-size: 1.2rem; font-weight: 700; }
        @media (max-width: 768px) {
            /* Mobile styles yahaan (ab simplified) */
            .product-table { display: block; overflow-x: auto; white-space: nowrap; }
            .product-table th, .product-table td { display: table-cell; white-space: nowrap; }
            .product-table thead, .product-table tbody, .product-table tr { display: table-row; }
        }
    </style>
</head>
<body>
    
    <nav> </nav>

    <section class="dashboard">
        <div class="container">
            
            <a href="/admin/agents" class="back-button">
                &larr; Back to Manage Agents
            </a>

            <h2 class="section-title">üí∞ Set Commission Rates</h2>
            <p style="text-align: center; color: #b0b0b0; margin-top: -20px; margin-bottom: 30px;">
                Yahaan set karein ki 'Cash' agent ko kitne rupaye (‚Çπ) aur 'Stars' agent ko kitne stars (‚≠ê) milenge.
            </p>

            {% with messages = get_flashed_messages(with_categories=true) %}
              {% if messages %}
                <div style="max-width: 100%; margin: 0 auto 20px auto;">
                {% for category, message in messages %}
                  <div class="flash-message {{ category }}">{{ message }}</div>
                {% endfor %}
                </div>
              {% endif %}
            {% endwith %}

            <form method="POST" action="{{ url_for('admin_commission_settings') }}">
            <div style="overflow-x: auto;">
                <table class="product-table">
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Price (‚Çπ)</th>
                            <th>Cash Comm (‚Çπ)</th>
                            <th>Stars Comm (‚≠ê)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% set current_category = "" %}
                        {% for product in products %}
                            {% if product.category != current_category %}
                                {% set current_category = product.category %}
                                <tr>
                                    <td colspan="4" class="category-header">
                                        {{ current_category|upper|replace('_', ' ') }}
                                    </td>
                                </tr>
                            {% endif %}
                            
                            <tr>
                                <td>{{ product.name }}</td>
                                <td>‚Çπ{{ "%.0f"|format(product.price) }}</td>
                                <td>
                                    <input type="number" 
                                           name="cash_comm_{{ product.id }}" 
                                           value="{{ settings[product.id].cash_commission_value if product.id in settings else 0 }}" 
                                           min="0" 
                                           step="1"
                                           class="price-input">
                                </td>
                                <td>
                                    <input type="number" 
                                           name="star_comm_{{ product.id }}" 
                                           value="{{ settings[product.id].star_commission_value if product.id in settings else 0 }}" 
                                           min="0"
                                           step="1" 
                                           class="price-input"
                                           style="color: #ffc107;"> </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button type="submit" class="btn-save">
                    SAVE ALL COMMISSION SETTINGS
                </button>
            </div>
            </form>

        </div>
    </section>

    <footer>
        <div class="container">
            <p>¬© 2025 ADI SELLX Admin Panel</p>
        </div>
    </footer>

</body>
</html>